context.modules = [
    {
        name = libpipewire-module-pipe-tunnel
        args = {
            # 1. PipeWire Node Properties
            node.name       = "snapcast-sink"
            node.description = "Snapcast Output Pipe"
            media.class     = "Audio/Sink"
            
            # 2. Module Configuration
            tunnel.mode = sink # Sets the module to act as an output sink (applications play to it)
            
            # 3. FIFO File Path
            pipe.filename = "/tmp/snapfifo"
            object.linger = true
            
            # 4. Audio Format Properties (Crucial for the reading application)
            # The receiver must read data matching this exact format.
            audio.format  = $ALSA_PLAYBACK_FORMAT
            audio.rate    = $ALSA_PLAYBACK_RATE
            audio.channels = $ALSA_PLAYBACK_CHANNELS
            audio.position = [ FL FR ]
            
            # 5. Optional Properties
            # tunnel.may-pause = true  # Allow the sink to be paused when idle
        }
    }
]
