context.modules = [
    { name = libpipewire-module-filter-chain
      args = {
          node.description = "10-Band EQ Sink"
          media.name       = "eq-sink"
          node.name        = "eq-sink"
          capture.props = {
            media.class = Audio/Sink
            audio.channels = 2
            audio.position = [ FL FR ]
          }
          playback.props = {
            node.name = "eq-sink-output"
            node.passive = true
            audio.channnels = 2
            audio.position = [ FL FR ]
          }
          filter.graph = {
              nodes = [
                  # --- CORRECTION APPLIED HERE ---
                  # Node 0: Preamp/Volume - Use bq_volume label
                  # { type = builtin name = volume label = bq_volume control = { "Volume" = 1.0 } }	

                  # Node 1: Band 1: 31 Hz 
                  { type = builtin name = eq_band_1 label = bq_peaking control = { "Freq" = 31.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 2: Band 2: 62 Hz 
                  { type = builtin name = eq_band_2 label = bq_peaking control = { "Freq" = 62.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 3: Band 3: 125 Hz
                  { type = builtin name = eq_band_3 label = bq_peaking control = { "Freq" = 125.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 4: Band 4: 250 Hz 
                  { type = builtin name = eq_band_4 label = bq_peaking control = { "Freq" = 250.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 5: Band 5: 500 Hz
                  { type = builtin name = eq_band_5 label = bq_peaking control = { "Freq" = 500.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 6: Band 6: 1 kHz
                  { type = builtin name = eq_band_6 label = bq_peaking control = { "Freq" = 1000.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 7: Band 7: 2 kHz
                  { type = builtin name = eq_band_7 label = bq_peaking control = { "Freq" = 2000.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 8: Band 8: 4 kHz
                  { type = builtin name = eq_band_8 label = bq_peaking control = { "Freq" = 4000.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 9: Band 9: 8 kHz
                  { type = builtin name = eq_band_9 label = bq_peaking control = { "Freq" = 8000.0 "Q" = 1.0 "Gain" = 0.0 } }

                  # Node 10: Band 10: 16 kHz
                  { type = builtin name = eq_band_10 label = bq_peaking control = { "Freq" = 16000.0 "Q" = 1.0 "Gain" = 0.0 } }
              ]

              # Chain the filters together sequentially
              links = [
                  # CORRECTION: The actual port is "Out" but we'll use "volume:Out" for consistency with the name
                  #+{ output = "volume:Out" input = "eq_band_1:In" } 
                  { output = "eq_band_1:Out" input = "eq_band_2:In" }
                  { output = "eq_band_2:Out" input = "eq_band_3:In" }
                  { output = "eq_band_3:Out" input = "eq_band_4:In" }
                  { output = "eq_band_4:Out" input = "eq_band_5:In" }
                  { output = "eq_band_5:Out" input = "eq_band_6:In" }
                  { output = "eq_band_6:Out" input = "eq_band_7:In" }
                  { output = "eq_band_7:Out" input = "eq_band_8:In" }
                  { output = "eq_band_8:Out" input = "eq_band_9:In" }
                  { output = "eq_band_9:Out" input = "eq_band_10:In" }
              ]
          }
      }
    }
]
